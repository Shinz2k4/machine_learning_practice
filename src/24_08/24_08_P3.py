# cập nhật toàn bộ dữ liệu ( đơn lẻ)

data = [(3, 250000), (2, 300000), (2, 150000), (1, 78000), (4, 150000)]
m, b = 0.0, 0.0
lr = 0.000001
eps = 1e-6
max_epoch = 1000

for epoch in range(max_epoch):
    max_grad = 0
    for x, y in data:
        y_pred = m * x + b
        error = y_pred - y

        dm = 2 * error * x
        db = 2 * error

        m -= lr * dm
        b -= lr * db

        max_grad = max(max_grad, abs(dm), abs(db))

    if epoch % 10 == 0:
        print(f"Epoch {epoch}: m = {m:.4f}, b = {b:.2f}")

    if max_grad < eps:
        print(f"\nHội tụ ở epoch {epoch}")
        break

print(f"\nKết quả cuối cùng: m = {m:.4f}, b = {b:.2f}")


# output
# Epoch 0: m = 4.6558, b = 1.86
# Epoch 10: m = 51.1942, b = 20.41
# Epoch 20: m = 97.6966, b = 38.95
# Epoch 30: m = 144.1629, b = 57.47
# Epoch 40: m = 190.5931, b = 75.99
# Epoch 50: m = 236.9873, b = 94.49
# Epoch 60: m = 283.3456, b = 112.97
# Epoch 70: m = 329.6679, b = 131.45
# Epoch 80: m = 375.9543, b = 149.91
# Epoch 90: m = 422.2048, b = 168.36
# Epoch 100: m = 468.4195, b = 186.79
# Epoch 110: m = 514.5983, b = 205.22
# Epoch 120: m = 560.7413, b = 223.63
# Epoch 130: m = 606.8485, b = 242.02
# Epoch 140: m = 652.9200, b = 260.41
# Epoch 150: m = 698.9557, b = 278.78
# Epoch 160: m = 744.9557, b = 297.13
# Epoch 170: m = 790.9201, b = 315.48
# Epoch 180: m = 836.8488, b = 333.81
# Epoch 190: m = 882.7419, b = 352.13
# Epoch 200: m = 928.5994, b = 370.44
# Epoch 210: m = 974.4214, b = 388.73
# Epoch 220: m = 1020.2078, b = 407.01
# Epoch 230: m = 1065.9587, b = 425.28
# Epoch 240: m = 1111.6741, b = 443.54
# Epoch 250: m = 1157.3540, b = 461.78
# Epoch 260: m = 1202.9986, b = 480.01
# Epoch 270: m = 1248.6077, b = 498.23
# Epoch 280: m = 1294.1815, b = 516.43
# Epoch 290: m = 1339.7199, b = 534.62
# Epoch 300: m = 1385.2230, b = 552.80
# Epoch 310: m = 1430.6908, b = 570.97
# Epoch 320: m = 1476.1233, b = 589.12
# Epoch 330: m = 1521.5206, b = 607.26
# Epoch 340: m = 1566.8827, b = 625.39
# Epoch 350: m = 1612.2096, b = 643.50
# Epoch 360: m = 1657.5014, b = 661.60
# Epoch 370: m = 1702.7580, b = 679.69
# Epoch 380: m = 1747.9795, b = 697.77
# Epoch 390: m = 1793.1660, b = 715.84
# Epoch 400: m = 1838.3173, b = 733.89
# Epoch 410: m = 1883.4337, b = 751.93
# Epoch 420: m = 1928.5151, b = 769.95
# Epoch 430: m = 1973.5615, b = 787.97
# Epoch 440: m = 2018.5730, b = 805.97
# Epoch 450: m = 2063.5495, b = 823.96
# Epoch 460: m = 2108.4912, b = 841.93
# Epoch 470: m = 2153.3980, b = 859.90
# Epoch 480: m = 2198.2699, b = 877.85
# Epoch 490: m = 2243.1071, b = 895.79
# Epoch 500: m = 2287.9095, b = 913.71
# Epoch 510: m = 2332.6771, b = 931.63
# Epoch 520: m = 2377.4100, b = 949.53
# Epoch 530: m = 2422.1082, b = 967.41
# Epoch 540: m = 2466.7717, b = 985.29
# Epoch 550: m = 2511.4005, b = 1003.15
# Epoch 560: m = 2555.9948, b = 1021.00
# Epoch 570: m = 2600.5544, b = 1038.84
# Epoch 580: m = 2645.0795, b = 1056.67
# Epoch 590: m = 2689.5700, b = 1074.48
# Epoch 600: m = 2734.0261, b = 1092.28
# Epoch 610: m = 2778.4476, b = 1110.07
# Epoch 620: m = 2822.8347, b = 1127.85
# Epoch 630: m = 2867.1873, b = 1145.61
# Epoch 640: m = 2911.5055, b = 1163.36
# Epoch 650: m = 2955.7894, b = 1181.10
# Epoch 660: m = 3000.0388, b = 1198.83
# Epoch 670: m = 3044.2540, b = 1216.54
# Epoch 680: m = 3088.4348, b = 1234.24
# Epoch 690: m = 3132.5814, b = 1251.93
# Epoch 700: m = 3176.6937, b = 1269.61
# Epoch 710: m = 3220.7718, b = 1287.27
# Epoch 720: m = 3264.8157, b = 1304.92
# Epoch 730: m = 3308.8254, b = 1322.56
# Epoch 740: m = 3352.8010, b = 1340.19
# Epoch 750: m = 3396.7424, b = 1357.81
# Epoch 760: m = 3440.6498, b = 1375.41
# Epoch 770: m = 3484.5230, b = 1393.00
# Epoch 780: m = 3528.3623, b = 1410.58
# Epoch 790: m = 3572.1675, b = 1428.15
# Epoch 800: m = 3615.9387, b = 1445.70
# Epoch 810: m = 3659.6760, b = 1463.24
# Epoch 820: m = 3703.3793, b = 1480.77
# Epoch 830: m = 3747.0487, b = 1498.29
# Epoch 840: m = 3790.6843, b = 1515.79
# Epoch 850: m = 3834.2859, b = 1533.28
# Epoch 860: m = 3877.8538, b = 1550.76
# Epoch 870: m = 3921.3878, b = 1568.23
# Epoch 880: m = 3964.8880, b = 1585.69
# Epoch 890: m = 4008.3545, b = 1603.13
# Epoch 900: m = 4051.7873, b = 1620.56
# Epoch 910: m = 4095.1863, b = 1637.98
# Epoch 920: m = 4138.5517, b = 1655.39
# Epoch 930: m = 4181.8834, b = 1672.79
# Epoch 940: m = 4225.1815, b = 1690.17
# Epoch 950: m = 4268.4460, b = 1707.54
# Epoch 960: m = 4311.6769, b = 1724.90
# Epoch 970: m = 4354.8742, b = 1742.25
# Epoch 980: m = 4398.0381, b = 1759.58
# Epoch 990: m = 4441.1684, b = 1776.90

# Kết quả cuối cùng: m = 4479.9571, b = 1792.48